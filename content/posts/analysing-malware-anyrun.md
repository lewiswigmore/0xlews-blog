+++
title = "Analysing a Malware Sample on ANY.RUN"
date = 2025-02-21T00:00:00+00:00
draft = false
tags = ["malware", "analysis", "tutorial"]
categories = ["Tutorials", "Malware"]
description = "A step-by-step guide to analysing malware samples using the ANY.RUN sandboxing service"
+++

This guide provides step-by-step instructions on how to analyse a malware sample on ANY.RUN. By following these steps, users can navigate the platform, search for existing malware samples, view connections and network traffic, collect IOCs, and gather more information about the threat.

## Navigate to ANY.RUN

Go to [ANY.RUN](https://app.any.run/).

## Public Tasks

Click "Public tasks" to view the public directory and submissions from the community.

![Public Tasks](/images/anyrun/public_task.png)

## Filter by Tag, Hash, or IOCs

Click here to filter by tag, hash, or other IOCs. This method allows us to quickly analyse existing malware samples instead of setting up our own sandbox.

![Filter by Tag](/images/anyrun/Filter_by_Tag.png)

## Search for Malware Samples

Search for any malware sample listed in the public directory. In this case, we are using the ransomware "lockbit".

## Select a Sample

Click on the sample references as malicious and matching the tag "lockbit". In this case, we are selecting the first sample in the list, referencing a .onion link.

![Select a Sample](/images/anyrun/Select_a_Sample.png)

## Connections Tab

The "Connections" tab allows you to view connections to and from this host during the sample analysis. This provides a holistic view of processes, ports, and traffic.

![Connections Tab](/images/anyrun/Connections_Tab.png)

## DNS Requests Tab

The "DNS Requests" tab provides a holistic view of connections to domains and their resolved IP(s).

![DNS Requests Tab](/images/anyrun/DNS_Requests_Tab.png)

## Threats Tab

The "Threats" tab provides a view of the specific processes and known threats associated with these.

![Threats Tab](/images/anyrun/Threats_Tab.png)

## IOC Tab

The "IOC" tab provides a summary of the detected Indicators of Compromise.

![IOC Tab](/images/anyrun/IOC_Tab.png)

## Processes Tab

You can drill down into individual processes in order of execution using the "Processes" tab on the right-hand side.

Alternatively, a graphical representation of the list of processes can be viewed using the "Graph" button.

![Processes Tab](/images/anyrun/Processes_Tab.png)

## Process Details

More details can be viewed by clicking on the process.

![Process Details](/images/anyrun/Process_Details.png)

## Child Processes

Reverting back to the list view, you can also view child processes spawned in the list.

![Child Processes](/images/anyrun/Child_Processes.png)

## Specific Process Example

The third process spawned in this sample is chrome.exe with the tag "lockbit" indicating that this process may be the execution stage of the attack.

![Specific Process Example](/images/anyrun/Specific_Process_Example.png)

## More Info

If we click "More Info", we can view the command line arguments performed by the system to launch this process and more details on the process executed.

![More Info](/images/anyrun/More_Info.png)

## ChatGPT3.5 Integration

Using the ChatGPT3.5 integration, we can view a summary of what is going on. While this may not be 100% accurate, it can help provide an initial understanding of the attack story.

![ChatGPT3.5 Integration](/images/anyrun/ChatGPT3.5_Integration.png)

## Reporting and Exports

### JSON Export

Optionally, a JSON export of this ChatGPT summary report can be downloaded.

![JSON Export](/images/anyrun/JSON_Export.png)

### Detailed Text Report

Finally, a detailed text report can be downloaded from the browser by clicking on the text report button.

![Detailed Text Report](/images/anyrun/Detailed_Text_Report.png)

## Full Analysis

The full analysis for the sample showed in this tutorial was previously available on ANY.RUN, but the link is no longer active as this analysis was performed some time ago.

![Full Analysis](/images/anyrun/Full_Analysis.png)

> **Note:** ANY.RUN's sandbox is an excellent resource for malware analysts, providing a quick way to understand malware behavior without having to set up your own analysis environment. However, remember that some samples might be removed or become unavailable over time.